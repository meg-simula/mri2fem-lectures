% For compatibility with acroread version 
\pdfminorversion=4


\documentclass[10pt, mathserif, aspectratio=169, t]{beamer}
\mode<presentation>

%\usefonttheme[onlymath]{serif}
\usepackage[T1]{fontenc}
%\usepackage{tgheros}
%\usepackage{tgadventor}
%\usepackage{libertine}
%\usepackage{theinhart}
\usepackage{helvet}
%\usepackage{newtxtext} %Times font only for text

% Use my theme
\usetheme{rognes}

% Used for image placement
\def\imagetop#1{\vtop{\null\hbox{#1}}}

% Misc packages
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\usepackage{stmaryrd}
\usepackage{tikz}
\usepackage{booktabs}
\usepackage{multirow}
\usetikzlibrary{arrows,shapes,backgrounds,decorations,mindmap,patterns,snakes}
\usepackage{amsmath, amssymb, amsthm, amscd}
\usepackage[english]{babel}
\usepackage{algorithm}
\usepackage{pythonhighlight}
\usepackage{epstopdf}
\usepackage{multimedia}
\usepackage{soul}

\newcommand{\R}{\mathbb{R}}
\DeclareMathOperator{\Div}{\mathrm{div}}
\DeclareMathOperator{\Curl}{\mathrm{curl}}
\DeclareMathOperator{\Grad}{\mathrm{grad}}
\DeclareMathOperator{\D}{d}
\newcommand{\foralls}{\forall \;}
\newcommand{\iinner}[2]{\llangle #1, #2 \rrangle}
\newcommand{\inner}[2]{\langle #1,  #2\rangle}
\newcommand{\totald}{\mathrm{d}}
\newcommand{\refer}[1]{\begin{flushright}{\tiny \textcolor{darkgray}{[#1]}}\end{flushright}}
\newcommand{\referinline}[1]{{\tiny \textcolor{darkgray}{[#1]}}}
\newcommand{\ddt}[1]{{#1}_t}
\newcommand{\Mi}{M_i}
\newcommand{\Me}{M_e}
\newcommand{\Iion}{I_{\rm{ion}}}
\newcommand{\dx}{\, \mathrm{d}x}
\newcommand{\ds}{\, \mathrm{d} s}
\newcommand{\triang}{\mathcal{T}}
\DeclareMathOperator{\trace}{tr}
\newcommand{\duality}[2]{\langle #1, #2 \rangle}

\newcommand{\mysection}[1]{\begin{frame} \begin{center} \vspace{3em} \textbf{#1} \end{center} \end{frame}}
\newcommand{\videosection}[3]{\begin{frame} \begin{center} \vspace{3em} \href{#2}{\textcolor{rognesred}{\textbf{#1}}} \end{center} #3 \end{frame}}
\newcommand{\sectionwithrefer}[2]{\begin{frame} \begin{center} \vspace{3em} \textbf{#1} \end{center} \refer{#2} \end{frame}}

\newtheorem{prop}[theorem]{Proposition}


\tikzstyle{na} = [baseline=-.5ex]
\tikzstyle{every picture}+=[remember picture]
\everymath{\displaystyle}

\usepackage[small, figurename=,size=scriptsize,font={color=darkgray}]{caption}



%% \usepackage{listings}
%% \usepackage[most]{tcolorbox} 	%used for writing process notes, code boxes 
%% \tcbuselibrary{listings,skins}  % skins needed for code box styles
%% \usepackage{color}
%% \usepackage{amsfonts}
%% \usepackage{fancyvrb}		%provides tab and white space preservation for 
%% 				%the verbatim environment. Needed for Python
%% 				%code inclusion

\definecolor{programcode}{gray}{0.65}

\def\formtmpX#1#2{{\vskip3pt\noindent\fboxsep=0pt{\parbox{\textwidth}{\hbox to \textwidth{\hskip3pt\vbox{\raggedright\noindent\textbf{#2\vphantom{Qy}}}\hfill}}}\vskip3pt\par
\noindent\kern0pt}}

\newenvironment{programcode}[1]{\ignorespaces\def\stmtopen##1{##1}%
\formtmpX{programcode}{\centerline{\small{#1}}}}{\noindent\textcolor{programcode}{\rule{\columnwidth}{0pt}}\par\addvspace{\baselineskip}}%



\newcommand{\terminal}[1]{
  \vspace{-1em}
  \begin{programcode}{}%{Terminal window}%
    \colorbox{blue!10}{\parbox{0.98\textwidth}{\textcolor{black}{\texttt{#1}}}}
  \end{programcode}
  \vspace{-0.5em}
}

\newcommand{\emp}[1]{\texttt{#1}}

%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------

\DeclareMathOperator{\ssum}{\textstyle \sum}

\begin{document}

%-------------------------------------------------------------------------------
\cleanpage
\begin{frame}
  \begin{columns}
    \begin{column}{0.25\textwidth}
    \centering
    \includegraphics[width=\textwidth]{graphics/simula_logo_main_RGB.pdf} \\
    \vspace{1em}
    \includegraphics[width=\textwidth]{graphics/waterscales.pdf}  \\
    \vspace{1em}
    \includegraphics[height=0.3\textwidth]{graphics/flag_yellow_low.jpg} 
    \hspace{0.2em}
    \includegraphics[width=0.3\textwidth]{graphics/logo-erc.jpg} \\
    \vspace{1em}
    \includegraphics[width=0.5\textwidth]{graphics/waterscape_logo.png} \\
    \vspace{1em}
    \includegraphics[width=\textwidth]{graphics/rcn-logo.pdf} \\
    \end{column}
    \begin{column}{0.75\textwidth}
    {
    \centering

      \vspace{4em}

      {\bf Brain modelling: \\ from magnetic resonance images \\ to finite element simulation} \\

      \bigskip
      \bigskip
      

      Marie E. Rognes \\
      \bigskip
      \bigskip

      Oslo, Norway \\
      \medskip
      Jan 15, 22, and 29 2021 \\
      }
    \end{column}
  \end{columns}
\end{frame}

\cleanpage

\begin{frame}
  \frametitle{Outline of lectures}
  \begin{center}
  \includegraphics[height=2.3cm]{/home/meg/papers/current/hikeandsurf/Book/graphics/chp1/T1-image-rot-white}
  \includegraphics[height=2.3cm]{/home/meg/papers/current/hikeandsurf/Book/graphics/chp1/ernie-volume-64}
  \includegraphics[height=2.3cm]{/home/meg/papers/current/hikeandsurf/Book/graphics/chp1/soltn-t30-crop}
  \end{center}
  \begin{description}
    \item[Lectures 1-2] Quick start: From brain MRI to FEM
    \item[Lectures 3-4] The poroelastic brain  
      \begin{enumerate}[I]
      \item
        % Observations and data
        The brain as a poroelastic medium: properties and forces
      \item
        % Mathematical and numerical modelling
        Models and numerics for the poroelastic brain at the macroscale
      \item
        % Hands-on meshing
        From hemispheres to brain meshes and simulations
      \end{enumerate}
    \item[Lectures 5-6] Introducing diffusion tensor images (anisotropy, parcellations)
  \end{description}
\end{frame}

\graphicspath{{/home/meg/presentations/slidesx/}}

\mysection{I: The brain as a poroelastic medium}

\input{/home/meg/presentations/slidesx/brain_poroelasticity.tex}
\input{/home/meg/presentations/slidesx/brain_pvs_hypotheses.tex}
\input{/home/meg/presentations/slidesx/brain_ecs_diffusion.tex}
\input{/home/meg/presentations/slidesx/brain_elasticity.tex}
\input{/home/meg/presentations/slidesx/brain_properties_evolve.tex}

\mysection{I: What do we know of the forces at play?}

\input{/home/meg/presentations/slidesx/brain_respiratory_2019_short.tex}
\input{/home/meg/presentations/slidesx/brain_blood_csf_interplay.tex}

\mysection{II: Porous media brain modelling}

\input{/home/meg/presentations/slidesx/biot_equations.tex}
\input{/home/meg/presentations/slidesx/brain_mpet_idea.tex}
\input{/home/meg/presentations/slidesx/brain_mpet_quasistatic.tex}


%% \begin{frame}
%%   \frametitle{Stability of saddle point problems}
%%   {\small
%%     \vspace{-1em}
%%     \begin{columns}[T]
%%     \begin{column}{0.5\textwidth}
%%       \begin{block}{Abstract form}
%%       Find $u \in V$ and $p \in Q$ such that
%%       \begin{align*}
%%         a(u, v) + b(v, p) &= \inner{f}{v} \quad \foralls v \in V \\
%%         b(u, q) - c(p, q) &= \inner{g}{q} \quad \foralls q \in Q 
%%       \end{align*}

%%       \begin{equation*}
%%       \begin{pmatrix}
%%         A & B^T \\
%%         B & -C 
%%       \end{pmatrix}
%%       \begin{pmatrix}
%%         u \\
%%         p
%%       \end{pmatrix}
%%       =
%%       \begin{pmatrix}
%%         f \\
%%         g
%%       \end{pmatrix}
%%       \end{equation*}
%%       \end{block}
%%       \includegraphics[width=\textwidth]{/home/meg/presentations/slides/graphics/saddlepoint.png} 
%%       \refer{Ladyzhenskaya (1969),  Babu\v ska (1972), Brezzi (1974)}
%%     \end{column}
%%     \begin{column}{0.5\textwidth}
%%           \vspace{-1em}
%%       \textbf{Example: (Time-discrete) Biot}
%%         \begin{align*}
%%           A u &= - \Div (2 \mu \varepsilon(u) + \lambda \Div u I) \\
%%           B u &= - \Div u \\
%%           C p &= c_0 p - \Div K \Grad p
%%         \end{align*}
%%         \visible<2->{
%%         \centering
%%         \includegraphics[width=0.3\textwidth]{/home/meg/presentations/slides/graphics/cg.png}
%%         \includegraphics[width=0.3\textwidth]{/home/meg/presentations/slides/graphics/bdm.png}
%%         \begin{block}{Stability conditions}
%%         Well-posed problem if $a, b, c$ continuous, $c$ pos. def., and
%%         $\exists \, \alpha, \beta > 0$
%%         \begin{align*}
%%           a(u, u) \geq \alpha \| u \|_V^2 \quad \foralls u \in \mathrm{ker} B \\
%%           \inf_{q \in Q} \sup_{v \in V} |b(v, q)| \|v\|_{V}^{-1} \|q\|_{Q}^{-1} \geq \beta 
%%         \end{align*}
%%       \end{block}
%%         \vspace{-1em}
%%         }
%%     \end{column}
%%   \end{columns}
%% }
%% \end{frame}

\mysection{II: Finite element methods for generalized poroelasticity}

\begin{frame}
\frametitle{Introducing notation for variational formulations}

Boundary conditions:

\bigskip
\bigskip

Initial conditions

\bigskip
\bigskip

$L^2$-inner product and norm (with weights)

\bigskip
\bigskip
\bigskip

$V$ \\
\bigskip
$Q_0$ \\
\bigskip
$Q_1, \dots, Q_J$

\end{frame}

\begin{frame}
  \frametitle{Deriving a finite element formulation for the MPET equations (I)}
  \begin{align*}
    - \Div (2 \mu \varepsilon(u) + \lambda \Div u \, \mathrm{I} - \alert{\ssum_{j} \alpha_j} p_j \, \mathrm{I} ) &= f, \\
    c_{j} \dot{p}_{j} + \alpha_{j} \Div \dot{u} - \Div K_{j} \Grad p_{j} + \alert{S_j} &= g_{j} \quad j = 1, \dots, J,
  \end{align*}
  where
  \begin{equation*}
    S_{j} =  \ssum_{i} \xi_{j \leftarrow i} (p_{j} - p_{i}).
  \end{equation*}
\end{frame}

\begin{frame}
  \frametitle{}
\end{frame}


\input{/home/meg/presentations/slidesx/brain_mpet_sisc_2019.tex}

\mysection{III: From hemispheres to brain meshes}

\mysection{Respecting gray and white matter}
\input{/home/meg/presentations/slidesx/mri2fem_gray_white.tex}

\mysection{Extracting the ventricular system}
\input{/home/meg/presentations/slidesx/mri2fem_ventricles.tex}

\mysection{Combining hemispheres}
\input{/home/meg/presentations/slidesx/mri2fem_combining_hemispheres.tex}

%% \mysection{Poroelastic brain simulations}

%% \videosection{Video example 4}{}{}

%% % For Lectures 5-6 I think: 

%% %\mysection{Parcellations}
%% %\videosection{Video example 5}{}{}

\mysection{Igor, bring me more brains!}
 
\begin{frame}
\frametitle{Want to give it a try? Natural next steps:}
\begin{enumerate}
\item
  Read Chapters 3-4 of \href{https://github.com/kent-and/mri2fem}{Mardal et al (2021)}
\item
  Try the scripts for generating meshes (gray/white, ventricles,
  joining hemispheres)
\item
  Examine your results in ParaView - do the markers and tags make
  sense? Are the boundaries/interfaces marked as expected?
\item
  Run a diffusion simulation with different diffusion coefficients in
  gray and white matter.
\item
  The source code associated with
  \href{https://doi.org/10.1137/18M1182395}{Lee, Piersanti, Mardal,
    Rognes (2019)} is also available on Zenodo:
  \href{http://doi.org/10.5281/zenodo.1215636}{http://doi.org/10.5281/zenodo.1215636}.
  Try the MPET code on one of the brain meshes? (Caveat: we haven't run it in a
  few years...)
\end{enumerate}
\end{frame}

%% %-------------------------------------------------------------------------------


\end{document}
